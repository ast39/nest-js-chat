<p align="center">
  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="200" alt="Nest Logo" /></a>
</p>

### Тикеты

1. Юзер (CLIENT) пишет сообщение.
- Если чат на его ID не создан - он создается автоматически
- Если чат имеет статус CLOSE - он автоматом становится OPEN и assigned сбрасывается
- Во всех отсальных случаях писать можно (при всех статусах)

2. Саппорт (SUPPORT) пишет в чат.
- Если чат имеет статус CLOSE - писать нельзя
- Если чат имеет статус OPEN - писать можно, assigned проставится автоматом, чат будет закреплен за менеджером
- Если чат имеет статус PROGRESS и занят другим менеджером (assigned !== userId) - писать нельзя
- Если чат имеет статус PROGRESS и никем не занят (assigned === null) - писать можно
- Если чат имеет статус PROGRESS и занят текущим менеджером (assigned === userId) - писать можно
- Если редактируется сообщение, то старая версия сообщения сохраняется в архиную таблицу

3. Редактирование сообщения.
- Если редактируется сообщение, то старая версия сообщения сохраняется в архивную таблицу.

4. Удаление сообщения
- Применяется soft удаление (меняется статус на isDeleted, физически сообщения остаются в БД).

5. Удаление тикетов
- Применяется soft удаление (меняется статус на isDeleted, физически тикеты остаются в БД).


### Чаты

1. Прежде чем писать в чат, его надо создать мнжду 2мя юзерами.
2. Юзер может писать только в чат, в котором он состоит
3. Админ может писать в любой чат
4. Юзер может редактировать только свое сообщение.
5. Если редактируется сообщение, то старая версия сообщения сохраняется в архивную таблицу.
6. К чатам и сообщениям применяется soft удаление (меняется статус на isDeleted, физически сообщения остаются в БД).